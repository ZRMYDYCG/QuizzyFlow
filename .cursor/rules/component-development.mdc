---
globs: src/components/material/**/*.ts,src/components/material/**/*.tsx
description: Material component development patterns
---

# Material Component Development Guide

## Component Structure

Each material component in [src/components/material](mdc:src/components/material) follows a consistent structure:

```
question-[component-name]/
├── index.ts              # Exports (component, interface, config)
├── index.tsx             # Main component implementation
├── interface.ts          # TypeScript interfaces and types
└── [component]-props.tsx # Property editor component
```

## Component Implementation Pattern

### 1. Interface Definition (interface.ts)

Define the component's properties interface and configuration:

```typescript
export interface QuestionInputPropsType {
  title?: string          // Display title
  placeholder?: string    // Input placeholder
  required?: boolean      // Is required field
  // ... other props
}

export interface QuestionInputConfigType {
  title: string           // Component type display name
  type: string           // Unique component type identifier
  props: QuestionInputPropsType  // Default props
}

export const QuestionInputDefaultProps: QuestionInputPropsType = {
  title: 'Input Title',
  placeholder: 'Please enter...',
  required: false,
}
```

### 2. Main Component (index.tsx)

Implement the component that will be rendered in the canvas/preview:

```typescript
import type { FC } from 'react'
import type { QuestionInputPropsType } from './interface'

const QuestionInput: FC<QuestionInputPropsType> = (props) => {
  const { title, placeholder, required } = { 
    ...QuestionInputDefaultProps, 
    ...props 
  }
  
  return (
    <div className="question-input">
      <div className="title">
        {required && <span className="required">*</span>}
        {title}
      </div>
      <input 
        placeholder={placeholder}
        className="w-full p-2 border rounded"
      />
    </div>
  )
}

export default QuestionInput
```

### 3. Props Editor ([component]-props.tsx)

Create a property editor component for the right panel:

```typescript
import type { FC } from 'react'
import { Input, Checkbox, Form } from 'antd'
import type { QuestionInputPropsType } from './interface'

interface PropsEditorProps {
  props: QuestionInputPropsType
  onChange: (newProps: QuestionInputPropsType) => void
  disabled?: boolean
}

const QuestionInputProps: FC<PropsEditorProps> = ({ 
  props, 
  onChange, 
  disabled 
}) => {
  const handleChange = (key: string, value: any) => {
    onChange({ ...props, [key]: value })
  }
  
  return (
    <Form layout="vertical">
      <Form.Item label="Title">
        <Input
          value={props.title}
          onChange={(e) => handleChange('title', e.target.value)}
          disabled={disabled}
        />
      </Form.Item>
      
      <Form.Item label="Placeholder">
        <Input
          value={props.placeholder}
          onChange={(e) => handleChange('placeholder', e.target.value)}
          disabled={disabled}
        />
      </Form.Item>
      
      <Form.Item>
        <Checkbox
          checked={props.required}
          onChange={(e) => handleChange('required', e.target.checked)}
          disabled={disabled}
        >
          Required
        </Checkbox>
      </Form.Item>
    </Form>
  )
}

export default QuestionInputProps
```

### 4. Index Exports (index.ts)

Export all parts of the component:

```typescript
import Component from './index'
import PropsComponent from './input-props'

export * from './interface'

export default Component
export { PropsComponent }
```

## Component Registration

### Adding to Material Components List

After creating a new component, register it in [src/components/material/index.ts](mdc:src/components/material/index.ts):

```typescript
import QuestionInput, { 
  PropsComponent as QuestionInputProps,
  QuestionInputDefaultProps,
  type QuestionInputPropsType 
} from './question-input'

export const componentConfigs = [
  // ... other components
  {
    title: 'Input',
    type: 'questionInput',
    Component: QuestionInput,
    PropsComponent: QuestionInputProps,
    defaultProps: QuestionInputDefaultProps,
  },
]
```

## Component Guidelines

### Naming Conventions
- **Component Folder**: `question-[name]` (kebab-case)
- **Component Name**: `Question[Name]` (PascalCase)
- **Props Type**: `Question[Name]PropsType`
- **Config Type**: `Question[Name]ConfigType`
- **Default Props**: `Question[Name]DefaultProps`

### Props Best Practices

1. **Always provide default props**: Every configurable property should have a sensible default
2. **Keep props flat**: Avoid deeply nested prop objects
3. **Use optional props**: Most props should be optional with defaults
4. **Type everything**: Use proper TypeScript types for all props

### Component Responsibilities

1. **Rendering**: The main component (index.tsx) should only handle rendering
2. **State**: Use local state for UI interactions, Redux for persisted data
3. **Props**: Receive configuration through props, don't fetch data inside
4. **Events**: Emit events to parent rather than handling side effects

### Styling Guidelines

1. **Use Tailwind**: Prefer Tailwind utility classes
2. **Ant Design for Complex UI**: Use Ant Design components when appropriate
3. **Responsive Design**: Ensure components work on mobile and desktop
4. **Theme Support**: Respect the theme context for dark/light mode

### Editor Component Guidelines

The props editor component should:
1. Provide intuitive controls for all configurable properties
2. Group related properties logically
3. Use appropriate input types (text, number, color, select, etc.)
4. Show validation feedback immediately
5. Be disabled when `disabled` prop is true

### Common Props to Include

Most components should support these standard props:
```typescript
interface StandardProps {
  title?: string          // Display title
  required?: boolean      // Is field required
  disabled?: boolean      // Is component disabled
  hidden?: boolean        // Is component hidden
  className?: string      // Additional CSS classes
}
```

## Example: Creating a New Component

To create a new "Question Badge" component:

1. Create folder: `src/components/material/question-badge/`
2. Define interfaces in `interface.ts`
3. Implement component in `index.tsx`
4. Create props editor in `badge-props.tsx`
5. Export in `index.ts`
6. Register in `src/components/material/index.ts`
7. Add to Redux store if needed
8. Test in the canvas editor

## Drag & Drop Integration

Components should work with the @dnd-kit system:
- Provide a unique `id` prop (using nanoid)
- Support the drag handle mechanism
- Handle selection state
- Support copy/paste operations

## Undo/Redo Considerations

Component prop changes should be:
- Dispatched through Redux actions
- Included in the undo/redo stack
- Properly merged with existing state

Note: Selection changes are excluded from undo/redo (see store configuration).
